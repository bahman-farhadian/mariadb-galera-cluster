# Galera Cluster Configuration
# Generated by Ansible - Node: {{ node_name }} ({{ node_ip }})

[mariadb]
server_id               = {{ server_id }}
binlog_format           = ROW
default_storage_engine  = InnoDB
innodb_autoinc_lock_mode = 2

# Galera Provider Configuration
wsrep_on                = ON
wsrep_provider          = /usr/lib/galera/libgalera_smm.so
wsrep_cluster_name      = "{{ cluster_name }}"
wsrep_cluster_address   = "gcomm://{% for node in mariadb_nodes %}{{ node.ip }}:{{ galera_port }}{% if not loop.last %},{% endif %}{% endfor %}{% if garbd_enabled %}{% for node in garbd_nodes %},{{ node.ip }}:{{ garbd_port }}{% endfor %}{% endif %}"
wsrep_node_address      = "{{ node_ip }}:{{ galera_port }}"
wsrep_node_name         = "{{ node_name }}"
wsrep_sst_method        = {{ sst_method }}
{% if sst_method == "mariabackup" %}
wsrep_sst_auth          = "{{ sst_user }}:{{ sst_password }}"
{% endif %}
wsrep_slave_threads     = 4
wsrep_log_conflicts     = ON
wsrep_provider_options  = "gcache.size=512M; gcache.page_size=512M"
